<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://cdn.jsdelivr.net/npm/three@0.130.1/build/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/three@0.130.1/examples/js/loaders/GLTFLoader.js"></script>

	<style>
		body {
			margin: 0;
		}
	</style>

	<title>Document</title>
</head>

<body>
	<script type="module">


		/////////////////////////////
		//     CAMERA ET SCENE     //
		/////////////////////////////

		const scene = new THREE.Scene();
		scene.background = new THREE.Color(0xa0a0a0);

		let SCREEN_WIDTH = window.innerWidth;
		let SCREEN_HEIGHT = window.innerHeight;
		let ratioLargeurHauteur = SCREEN_WIDTH / SCREEN_HEIGHT;

		const camera = new THREE.PerspectiveCamera(75, ratioLargeurHauteur, 0.1, 1000);
		camera.position.z = 5;

		const renderer = new THREE.WebGLRenderer();
		renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
		document.body.appendChild(renderer.domElement);

		function onWindowResize() {
			console.log("Redimensionnement de la fenêtre");
			SCREEN_WIDTH = window.innerWidth;
			SCREEN_HEIGHT = window.innerHeight;
			ratioLargeurHauteur = SCREEN_WIDTH / SCREEN_HEIGHT;

			camera.aspect = ratioLargeurHauteur;
			camera.updateProjectionMatrix();

			renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
		}

		window.addEventListener("resize", onWindowResize)

		var light = new THREE.PointLight(0xffffff, 1, 100);
		light.position.set(0, 0, 10);
		scene.add(light);

		/////////////////////////////
		//         BALLONS         //
		/////////////////////////////

		var loader = new THREE.GLTFLoader();

		loader.load('uploads_files_2483092_Balloon.gltf', function (gltf) {
			var ballon = gltf.scene;
			scene.add(ballon);

			// Position du ballon en bas de l'écran, aléatoire en x
			var ballonPositionY = -5
			ballon.position.y = ballonPositionY;

			var targetPositionY = 5;
			var animationDuration = 5000;
			var animationStartTime = Date.now();

			function animateBallon() {
				var now = Date.now();
				var elapsed = now - animationStartTime;
				var progress = elapsed / animationDuration;

				if (progress < 1) {
					ballon.position.y = ballonPositionY + (targetPositionY - ballonPositionY) * progress;
					requestAnimationFrame(animateBallon);
				}
			}

			animateBallon();
		}, undefined, function (error) {
			console.error(error);
		});

		/////////////////////////////
		//          RENDU          //
		/////////////////////////////

		function animate() {
			requestAnimationFrame(animate);
			renderer.render(scene, camera);
		}

		animate();

	</script>
</body>

</html>